analyzers:
  - cmd: /usr/local/bin/nfdump-wrapper.sh
    name: nfdump
    globs: ["*.json"]
    shaper: |
      type netflow = {
        type: string,
        sampled: int64,
        export_sysid: int64,
        t_first: time,
        t_last: time,
        proto: int64,
        src4_addr: ip,
        dst4_addr: ip,
        icmp_type: int64,
        icmp_code: int64,
        src_port: uint16,
        dst_port: uint16,
        fwd_status: int64,
        tcp_flags: string,
        src_tos: int64,
        in_packets: int64,
        in_bytes: int64,
        cli_latency: float64,
        srv_latency: float64,
        app_latency: float64,
        label: string
      }
      put this := shape(netflow)
